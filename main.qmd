---
title: LIS 461 In Class Examples
author: Mariah A. Knowles
format:
  html:
    code-fold: true
jupyter: julia-1.8
---

# Install Packages

```{julia}
using Pkg
Pkg.add("CSV")
Pkg.add("DataFrames")
Pkg.add("Plots")
Pkg.add(url="https://github.com/snotskie/EpistemicNetworkAnalysis.jl")
```

# Load Packages

```{julia}
using CSV
using DataFrames
using Plots
using EpistemicNetworkAnalysis
```

# Load Data

```{julia}
data = DataFrame(CSV.File("data.tsv"))
for col in names(data)
    data[!, col] = replace(data[!, col], missing => 0)
end
```

# Bar Chart

```{julia}
good_codes = [
    :GOOD_ASPECTS,
    :GOOD_CHASE,
    :GOOD_FLOW,
    :GOOD_TOP_DETAIL,
    :GOOD_VARIETY,
]

common_codes = [
    :CITATIONS,
    :BURIED_CLAIM,
    :UNCLEAR_STRATEGY,
    :SPECIFIC_CASE,
    :MORAL_PREMISE,
    :WASHY,
    :MIXED_THEORY,
]

uncommon_codes = [
    :THINKING,
    :HEDGE,
    :PASSIVE,
    :DOES_NOT_FOLLOW,
    :HISTORY,
    :ADJ,
    :COMPLEX,
    :JARGON,
    :NOSE,
    :PAREN_RHET_Q,
    :PRONOUNS,
    :SHOULD,
    :SNARK,
    :TIMING,
    :WALL,
    :EXAMPLES,
    :REDUNDANT,
    :SUMMARIZE,
    :DAMAGE,
    :DISTILL,
    :MORELESS,
    :PREMISE_CLAIM,
    :STRAWMAN
]

all_codes = [good_codes..., common_codes..., uncommon_codes...]

plot(string.(all_codes),
    [sum(data[!, code]) for code in all_codes],
    seriestype=:bar,
    rotation=-90,
    xticks=:all)
```

# Model Options

```{julia}
biplot_only = (i, j, ci, cj) -> i == j
most_variance = SVDRotation()
grader_differences = MulticlassRotation(:Grader)
first_vs_second = MeansRotation(:Assignment, "Workshop 1", "Workshop 2")
connected_assignments = [:RandomID]
separate_assignments = [:RandomID, :Assignment]
```

# Plots

What kind of feedback are students individually receiving across their workshops?

```{julia}
ena = ENAModel(
    data, common_codes, connected_assignments, connected_assignments,
    dropEmpty=true,
    rotateBy=most_variance
)

display(ena)
plot(ena)
```

How did feedback on the first workshop compare to the second, on average?

```{julia}
ena = ENAModel(
    data, common_codes, separate_assignments, separate_assignments,
    dropEmpty=true,
    relationshipFilter=biplot_only,
    rotateBy=first_vs_second
)

display(ena)
plot(ena)
```

How did feedback given by different graders compare, on average?

```{julia}
ena = ENAModel(
    data, common_codes, separate_assignments, separate_assignments,
    dropEmpty=true,
    relationshipFilter=biplot_only,
    rotateBy=grader_differences
)

display(ena)
plot(ena)
```